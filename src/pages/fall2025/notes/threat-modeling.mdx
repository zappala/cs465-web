---
layout: ../../../layouts/SemesterMarkdown.astro
---

import { Image } from "astro:assets";
import figure_1_1 from "@/images/security-book/figure-1.1.png";
import figure_1_4 from "@/images/security-book/figure-1.4.png";
import figure_1_5 from "@/images/security-book/figure-1.5.png";
import data_flow_diagram_online_banking_application from "@/images/notes/data-flow-diagram-online-banking-application.png";
import figure_1_7 from "@/images/security-book/figure-1.7.png";
import figure_1_9 from "@/images/security-book/figure-1.9.png";

# Threat modeling

## Questions on the readings

The readings today are from
[Computer Security and the Internet](https://people.scs.carleton.ca/~paulv/toolsjewels.html),
[Chapter 1](https://people.scs.carleton.ca/~paulv/toolsjewels/TJrev1/ch1-rev1.pdf),
sections 1.0 - 1.2, 1.4 - 1.8

## Review

Some important material that may not be in the book (see below notes):

- Threat Modeling Manifesto
- OWASP
- attackers: examples of adversaries
- strategies: card games

## Exercises

Consider this example of an online banking application:

<Image
  alt="online banking application"
  src={data_flow_diagram_online_banking_application}
/>

- What can go wrong?
  - identify an issue
- What are we going to do about it?
  - identify a fix
- Repeat for as much time as we have
- This exercise is designed to help you develop a security mindset

## Fundamental goals of security

- Ultimate goal: Help users complete their desired task safely and without
  short- or long-term risk

<Image
  alt="confidentiality, integrity, availability, authentication, authorization, accounting"
  src={figure_1_1}
/>

- CIA triad

  - confidentiality
  - integrity
  - availability

- AAA security

  - authentication
  - authorization
  - accounting

## Security Analysis

- Open-ended activity to identify vulnerabilities and design defenses

<Image alt="security analysis" src={figure_1_4} />

Key points:

- security analysis must be done throughout the software lifecycle
- a formal security analysis can be done once a product is developed, to review
  against security standards (either from industry or government)
- penetration testing can be done once a product is deployed

## Threat Modeling

- Key part of a security analysis

- wide variety of definitions

- Book:

> A threat model identifies threats, threat agents, and attack vectors that the
> target system considers in scope to defend against

- [Threat modeling manifesto](https://www.threatmodelingmanifesto.org):

> Threat modeling is analyzing representations of a system to highlight concerns
> about security and privacy characteristics

- [OWASP](https://owasp.org/www-community/Threat_Modeling):

> Threat modeling works to identify, communicate, and understand threats and
> mitigations within the context of protecting something of value.

Four questions from the threat modeling manifesto:

1. What are we working on?
1. What can go wrong?
1. What are we going to do about it?
1. Did we do a good enough job?

Items included in a threat model, from OWASP:

- Description of the subject to be modeled
- Assumptions that can be checked or challenged in the future as the threat
  landscape changes
- Potential threats to the system
- Actions that can be taken to mitigate each threat
- A way of validating the model and threats, and verification of success of
  actions taken

<Image alt="components of threat modeling" src={figure_1_5} />

- The task of threat modeling is open-ended -- long list of questions,
  redrawing, reconsidering

## What are we working on?

- architectural diagram of system
- identify where information is stored in the system and how access is granted
  to that information
- identify flows of control

- example of password flow:

<Image alt="password flow diagram" src={figure_1_7} />

## What can go wrong?

- model adversaries
- use attack taxonomies or playing cards

### Modeling Adversaries

Consider:

- who are they?
- what are their objectives?
- what are their methods?
- what are their capabilities?

Examples:

- foreign intelligence
- cyber terrorists
- industrial spy
- organized crime
- crackers
- malicious insiders
- non-malicious employees

### Card games

- [Elevation of Privilege playing cards](https://shostack.org/games/elevation-of-privilege)
  - [Escalation of Privilege Cards PDF](/code/threat-modeling/v1/EoP-DECK-ALL-CARDS.pdf)
  - [Introduction of the game at BlackHat by Adam Shostack](https://www.youtube.com/watch?v=gZh5acJuNVg)
- [OWASP Cornucopia](https://owasp.org/www-project-cornucopia/)
  - [Cornucopia Web Application Cards PDF](/code/threat-modeling/v1/owasp_cornucopia_webapp_2.00_guide_bridge_en.docx)
  - [How to Play Cornucopia](https://www.youtube.com/watch?v=XXTPXozIHow)
- [Security Cards](http://securitycards.cs.washington.edu/index.html)
  - [Security Cards PDF](/code/threat-modeling/v1/security-cards-deck.pdf)

### STRIDE

- Helpful for considering possible attacks

- Includes:

  - Spoofing: attempts to impersonate a thing or an entity
  - Tampering: unauthorized altering of code, data, packets, etc.
  - Repudiation: denying responsibility for past actions
  - Information disclosure: unauthorized release of data
  - Denial of service: preventing access to services through malicious actions
  - Elevation of privilege: gaining unpermitted access to resources

### Enumerating Attacks

- one of the goals of a threat modeling exercise

<Image alt="enumeration of attacks" src={figure_1_9} />

## What are we going to do about it?

- Important part of a threat modeling exercise
- Want to generate a list of action items (tickets) for the organization so
  threats can be mitigated

## Did we do a good enough job?

- Longer-term activity
- Requires metrics / measurement / logging to see if anticipated threats are
  stopped or new threats arise
- Can include using outside consultants

## Gaps in a threat model

- May make invalid assumptions about the system
- Difficult to always anticipate threats

- Example from the book:

> You check into a hotel in a foreign country. You do not speak the language
> well. The hotel staff appears courteous, but each time you visit the lobby it
> seems a different face is behind the front desk. Your room has a small safe,
> the electronic type with its door initially open (unlocked), allowing guests
> at that point to choose their own combination. Upon three incorrect attempted
> combinations, the safe enters a lockout mode requiring hotel maintenance to
> reset it. You choose a combination, remember it, stash your money, close the
> box, then go swimming.
>
> Is your money secure? The natural assumption is that a thief, trying to open
> the lock by guessing your combination, will with high probability guess wrong
> three times, leaving your money safe inside.
>
> But, do you trust the hotel staff? Someone in maintenance must know the reset
> or master combination to allow for hotel guests who either forget their
> combination or enter three wrong tries. If you return and the money is gone,
> do you trust the hotel maintenance staff to help you investigate? Can you
> trust the hotel management? And the local policeâ€”are they related to hotel
> staff or the owner? (What implicit assumptions have you made?)

- Need to be sure to update threat model as adversaries, technology, system
  change

- Consider Figure 1.9 again -- what about a malicious browser extension?

## After-class Exercises

- watch [How to Play Cornucopia](https://www.youtube.com/watch?v=XXTPXozIHow) to
  learn more about threat modeling

- Find a group of 4 to 5 friends and build a threat model for a modern
  automobile that

  - runs a sophisticated software system that controls all aspects of the car
  - is connected at all times via a satellite system
  - accepts patches over-the-air for the software system

- for the threat model

  - 10 minutes developing a system diagram
  - 10 minutes identifying threats
  - 10 minutes identifying countermeasures
  - 15 minutes for discussion
