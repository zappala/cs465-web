---
layout: ../../../layouts/SemesterMarkdown.astro
---

# Defenses and Privilege escalation

## Ungraded Quiz

- explain how a stack canary works
- why does ASLR make it harder to run a simple stack-based buffer overflow attack?
- explain a simple example of how privilege escalation can work

## Key Concepts

### Buffer overflow defenses

- make stack and heap non-executable
  - flag specified address ranges as non-executable
  - [Windows allows you to turn on Data Execution Prevention](https://support.microsoft.com/en-us/topic/what-is-data-execution-prevention-dep-60dabc2b-90db-45fc-9b18-512419135817)
  - [details on how DEP works](https://learn.microsoft.com/en-us/windows/win32/memory/data-execution-prevention)
- stack canary
  - inserted into stack to detect code injection
  - can also use a heap canary
- run-time bounds checking
  - instrumented by compiler
- memory layout randomization (ASLR)
  - makes it more difficult for an attacker to predict where code is loaded when a buffer is overflowed
- type-safe languages
  - [see NIST safer languages](https://www.nist.gov/itl/ssd/software-quality-group/safer-languages)
  - [type safety in Rust](https://doc.rust-lang.org/nomicon/meet-safe-and-unsafe.html)
- safe C libraries
- static analysis tools -- tools that analyze your code and warn you

### Adoption Barriers

- no governing body
- backwards compatibility
- incomplete solutions

### Privilege escalation

- may be able to break into a low-privilege account first, then need to try to gain higher privileges
  - from a fixed program to a shell
  - from a sandbox to a complete system
  - from non-root to root
  - from root to kernel
- see simple example, page 175
- some ports are privileged, so the programs given access to those ports are targets for an attacker
- follow best practices! don't use root accounts, don't put untested programs on privileged ports
- [privilege escalation CVEs](https://www.cvedetails.com/google-search-results.php?q=escalation#gsc.tab=0&gsc.q=escalation&gsc.sort=date)

### Extra Reading

- [Return-Oriented Programming: Systems, Languages, and Applications](https://dl.acm.org/doi/10.1145/2133375.2133377)
- [tutorial on return-oriented programming](https://codearcana.com/posts/2013/05/28/introduction-to-return-oriented-programming-rop.html)
- [Practical Timing Side Channel Attacks against Kernel Space ASLR](https://ieeexplore.ieee.org/document/6547110?denied=)
- [Position-Independent Code Reuse: On the Effectiveness of ASLR in the Absence of Information Disclosure](https://ieeexplore.ieee.org/document/8406602)
